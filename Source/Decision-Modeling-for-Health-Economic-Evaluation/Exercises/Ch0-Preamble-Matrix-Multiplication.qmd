# Preamble on matrix operations {.unnumbered}

When building markov molds and building transition matrices, using matrix-vector multiplications simplifies manual computation significantly.

To multiply a matrix by a vector we must have the same number of columns in the matrix as rows in a vector. Consider below an example of a two-state markov model and the goal is to discern the proportion left in the first state after two time cycles. We also show how to select rows and columns of a matrix.

## Matrix multiplication example

First, we will create our vector called `iVec_example`. The number of entries in this vector should be the same as the number of states. In this example we will assume that everyone starts in the first state.

Note: the `c()` operation initializes a vector (it is considered by default a column vector)

```{r Preamble}
iVec_example <- c(1,0)
```

\
Below, we consider a two-state markov model. We build a 2 x 2 matrix of the transition probabilities:

```{r example markov model}
tProbs_example <- matrix(c(0.7,0.3,
                           0.1,0.9),
                 nrow = 2, ncol = 2,
                 byrow = T)
```

\
Now, we want to calculate the proportion of individuals in the first time-cycle. The results will be saved in `time1Prop`

:::{.callout-note}
Note: the number of columns in the matrix must match the number of rows in the vector.
:::

```{r example multiply matrix time 1}
time1Prop <- tProbs_example %*% iVec_example
```

\
To get the proportion after the second-time we can multiply the first-time proportion that we just calculated by the transition probability matrix

```{r example multiply matrix time 2}
time2Prop <- tProbs_example %*% time1Prop
```

\
We can use the `[i,j]` operator to extract row *i* and column *j* of a matrix

```{r example extract matrix data 1}
tProbs_example[1,] #extracts the first row
tProbs_example[,2] #extracts the second column

tProbs_example[1,2] #extracts first row and second column entry
```

\
We can also use the *-i* operator to extract **all except** *i*

```{r example extract matrix data 2}
tProbs_example[-1,]  #extracts all but the first row
tProbs_example[,-1]  #extracts all but the column
```
